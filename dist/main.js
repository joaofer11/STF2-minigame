(()=>{"use strict";var t={293:(t,e,i)=>{t.exports=i.p+"asset-modules/images/9b0201b69f69f00dbf59.png"},888:(t,e,i)=>{t.exports=i.p+"asset-modules/images/7b60236c64712a72ca4e.png"}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var o=e[s]={exports:{}};return t[s](o,o.exports,i),o.exports}i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var s=e.getElementsByTagName("script");s.length&&(t=s[s.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),(()=>{var t=i(888);function e(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var s=new Image;s.src=t;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sourceImg=s,this.state={currentState:"idle",nextState:"idle"},this.sX=[0,60,120,180],this.sY=[0,0,0,0],this.sW=60,this.sH=132,this.cX=30,this.cY=80,this.cW=60,this.cH=132,this.position=30,this.minFrame=0,this.maxFrame=4,this.animationActive=!0,this.backgroundTransition=null,this.FPS=0,this.maxFPS=6,this.keyPressed=!1,this.lockedControls=!1,this.timeout=null}var i,n;return i=t,n=[{key:"animate",value:function(t,e){this.backgroundTransition=e,this.checkState(),t.drawImage(this.sourceImg,this.sX[this.minFrame],this.sY[this.minFrame],this.sW,this.sH,this.cX,this.cY,this.cW,this.cH),this.FPS++}},{key:"checkState",value:function(){"idle"===this.state.currentState?this.setIdle():"leftMovement"===this.state.currentState?this.setLeftMovement():"rightMovement"===this.state.currentState?this.setRightMovement():"jump"===this.state.currentState?(this.setJump(),"jump"===this.state.currentState&&"rightMovement"===this.state.direction?this.fixRightMovement():"jump"===this.state.currentState&&"leftMovement"===this.state.direction&&this.fixLeftMovement()):"crouch"===this.state.currentState&&this.setCrouch()}},{key:"updateFrame",value:function(){this.FPS%this.maxFPS==0&&(this.minFrame=(this.minFrame+1)%this.maxFrame)}},{key:"resetDefault",value:function(){this.lockedControls&&"idle"===this.state.nextState&&(this.init(),this.lockedControls=!1),this.position="crouch"===this.state.currentState?this.position:this.cX,this.state={currentState:"idle",nextState:"idle"},this.animationActive=!1,this.maxFrame=4,this.keyPressed=!1}},{key:"setIdle",value:function(){this.animationActive||(this.sX=[0,60,120,180],this.sY=[0,0,0,0],this.animationActive=!0),this.updateFrame(),this.fixIdlePosition()}},{key:"fixIdlePosition",value:function(){switch(this.minFrame){case 0:this.cX=this.position,this.cY=80;break;case 1:this.cX=this.position+1,this.cY=80;break;case 2:this.cX=this.position+2,this.cY=80;break;case 3:this.cX=this.position+3,this.cY=80}}},{key:"setLeftMovement",value:function(){this.keyPressed||(this.sX=[246,305,366,426,486,545],this.sY=[0,0,0,0,0,0],this.minFrame=0,this.maxFrame=6,this.keyPressed=!0),this.fixLeftMovement(),this.updateFrame()}},{key:"fixLeftMovement",value:function(){this.cX>0&&!this.backgroundTransition.itsTransition&&(this.cX-=2)}},{key:"setRightMovement",value:function(){this.keyPressed||(this.sX=[246,305,366,426,486,545],this.sY=[0,0,0,0,0,0],this.maxFrame=6,this.keyPressed=!0),this.updateFrame(),this.fixRightMovement()}},{key:"fixRightMovement",value:function(){this.cX<300&&!this.backgroundTransition.itsTransition&&(this.cX+=2)}},{key:"setJump",value:function(){this.keyPressed||(this.sX=[610,671,721,772],this.sY=[0,0,0,0],this.minFrame=0,this.maxFrame=4,this.keyPressed=!0),this.fixJumpPosition()}},{key:"fixJumpPosition",value:function(){var t=this;80===this.cY&&0===this.minFrame?this.updateFrame():1===this.minFrame&&this.cY>62?(this.cY-=7,this.cY<=62&&this.minFrame++):2===this.minFrame&&this.cY>0?(this.cY-=this.state.velocity,this.state.velocity-=this.state.gravity,this.cY<=6&&this.minFrame++):3===this.minFrame&&this.minFrame>0&&(this.cY-=this.state.velocity,this.state.velocity-=this.state.gravity,this.cY>=80&&(this.minFrame=0,setTimeout((function(){t.state.nextState="idle",t.resetDefault()}),50)))}},{key:"setCrouch",value:function(){this.keyPressed||(this.sX=[831,890],this.sY=[0,0],this.minFrame=0,this.maxFrame=2,this.keyPressed=!0),this.fixCrouchPosition()}},{key:"fixCrouchPosition",value:function(){switch(this.minFrame){case 0:this.cX=this.position+3,this.updateFrame();break;case 1:this.cX=this.position+5}}},{key:"addControls",value:function(){document.querySelectorAll('[data-js="control-buttons"]').forEach(this.addButtons),console.log("add"),document.addEventListener("keydown",this.checkKey),document.addEventListener("keyup",this.checkKey)}},{key:"addButtons",value:function(t){t.addEventListener("touchstart",this.checkButton),t.addEventListener("touchend",this.checkButton)}},{key:"removeControls",value:function(){this.lockedControls||(document.querySelectorAll('[data-js="control-buttons"]').forEach(this.removeButtons),console.log("removido"),document.removeEventListener("keydown",this.checkKey),document.removeEventListener("keyup",this.checkKey),this.lockedControls=!0)}},{key:"removeButtons",value:function(t){t.removeEventListener("touchstart",this.checkButton),t.removeEventListener("touchend",this.checkButton)}},{key:"checkKey",value:function(t){var e=this,i="keydown"===t.type,s="keyup"===t.type,n=t.key;console.log(this.state),i&&"ArrowUp"!=n?this.mapMovementList(n):i&&"ArrowUp"===n?(this.mapMovementList(n),"static"===this.state.direction&&setTimeout((function(){return e.removeControls()}),130)):i&&"LR"===this.state.movement?console.log("ta funcjonado"):s&&"idle"===this.state.nextState&&this.resetDefault()}},{key:"checkButton",value:function(t){var e=this,i="touchstart"===t.type,s="touchend"===t.type,n=t.target.parentNode.classList[1];i&&"ArrowUp"!=n?this.mapMovementList(n):i&&"ArrowUp"===n?(this.mapMovementList(n),"static"===this.state.direction&&setTimeout((function(){return e.removeControls()}),130)):s&&"idle"===this.state.nextState&&this.resetDefault()}},{key:"mapMovementList",value:function(t){"ArrowLeft"===t&&"jump"===this.state.currentState?(this.state.direction="leftMovement",console.log("ativou")):"ArrowRight"===t&&"jump"===this.state.currentState?this.state.direction="rightMovement":"ArrowLeft"===t?this.state={currentState:"leftMovement",nextState:"idle",movement:"LR"}:"ArrowRight"===t?this.state={currentState:"rightMovement",nextState:"idle",movement:"LR"}:"ArrowUp"===t?this.state={currentState:"jump",direction:"static",nextState:"fall",gravity:.36,velocity:6}:"ArrowDown"===t&&(this.state={currentState:"crouch",nextState:"idle"})}},{key:"bindEvents",value:function(){this.checkKey=this.checkKey.bind(this),this.addButtons=this.addButtons.bind(this),this.checkButton=this.checkButton.bind(this),this.removeButtons=this.removeButtons.bind(this)}},{key:"init",value:function(){this.bindEvents(),this.addControls()}}],n&&e(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),t}(),o=i(293);function a(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var h=new Image;h.src=o;var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.standardStates=new n,this.sourceImg=h,this.sX=155.25,this.sY=0,this.sW=310.5,this.sH=224,this.cX=0,this.cY=0,this.cW=360,this.cH=224,this.FPS=0,this.maxFPS=3,this.itsHoldingTouch=!1,this.timer=null,this.transition={direction:null,itsTransition:!1},this.characterPosition=null}var e,i;return e=t,i=[{key:"animate",value:function(t,e){this.characterPosition=e,this.checkTransition(),t.drawImage(this.sourceImg,this.sX,this.sY,this.sW,this.sH,this.cX,this.cY,this.cW,this.cH),this.FPS++}},{key:"checkTransition",value:function(){switch(this.transition.direction){case"toLeft":this.transitionStageToLeft();break;case"toRight":this.transitionStageToRight()}}},{key:"transitionStageToLeft",value:function(){this.sX>0&&this.characterPosition<=15&&(this.sX-=1,this.transition.itsTransition=!0)}},{key:"transitionStageToRight",value:function(){this.sX<304&&this.characterPosition>=280&&(this.sX+=1,this.transition.itsTransition=!0)}},{key:"addControls",value:function(){document.querySelectorAll('[data-js="control-buttons"]').forEach(this.addButtons),document.addEventListener("keydown",this.checkKey),document.addEventListener("keyup",this.checkKey)}},{key:"addButtons",value:function(t){t.addEventListener("touchstart",this.checkButton),t.addEventListener("touchmove",this.checkButton),t.addEventListener("touchend",this.checkButton)}},{key:"checkKey",value:function(t){var e="keydown"===t.type,i="keyup"===t.type;e?this.mapTransitionDirection(t.key):i&&(this.transition.direction=null,this.transition.itsTransition=!1)}},{key:"checkButton",value:function(t){var e="touchstart"===t.type,i=(t.type,"touchend"===t.type),s=t.target.parentNode.classList[1];e?this.mapTransitionDirection(s):i&&(this.transition.direction=null,this.transition.itsTransition=!1)}},{key:"mapTransitionDirection",value:function(t){switch(t){case"ArrowLeft":this.transition.direction="toLeft";break;case"ArrowRight":this.transition.direction="toRight"}}},{key:"bindEvents",value:function(){this.checkKey=this.checkKey.bind(this),this.addButtons=this.addButtons.bind(this),this.checkButton=this.checkButton.bind(this)}},{key:"init",value:function(){this.bindEvents(),this.addControls()}}],i&&a(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}(),c=document.querySelector("#my-canvas").getContext("2d"),u=new r,m=new n;u.init(),m.init(),function t(){u.animate(c,m.cX),m.animate(c,u.transition),requestAnimationFrame(t)}()})()})();
